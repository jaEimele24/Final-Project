from ggame import App, RectangleAsset, ImageAsset, SoundAsset
from ggame import LineStyle, Color, Sprite, Sound, Frame
import math, random
from time import time
civname=input("enter your civilization's name here: ")


class CivGame(App):
    def __init__(self):
        super().__init__()
        black = Color(0x458B00,1)
        noline = LineStyle(0, black)
        bg_asset = RectangleAsset(self.width, self.height, noline, black)
        bg = Sprite(bg_asset, (0,0))
        self.farmland=float(input("enter the initial amount of airable land here: "))
        self.forests=float(input("enter the initial amount of forests here: "))
        self.k=0
        self.metaldeposits=float(input("enter the amount of usable metals deposits there are: "))
        self.initialtechlevel=input("enter the initial tech level here, either ancient, classical, mideval, renessance, industrial, modern, or future: ")
        pop=float(input("enter the initial population here,  at least 10 is optimal: "))
        self.techlevel=self.initialtechlevel
        self.pop=Population(pop, self.farmland, self.k, self.forests, self.initialtechlevel, self.metaldeposits, self.techlevel)
    def step(self):
        self.pop.step()
#Population Dynamics
class Population:
    def __init__(self, pop, farmland, k, forests, initialtechlevel, metaldeposits, techlevel):
        self.pop=pop
        self.farmland=farmland
        self.k=k
        self.forests=forests
        self.initialtechlevel=initialtechlevel
        self.metaldeposits=metaldeposits
        self.techlevel=techlevel
        self.techadvanceprogress=0
        self.houses=0
        self.tools=0
        self.barrels=0
        self.ore=0
        self.consumergoods=0
        self.ingots=0
        self.weapons=0
    def step(self):
        self.k=self.k+1
        if self.k==1:
            if self.initialtechlevel=="ancient" and self.techlevel=="ancient":
                labor=self.pop
                woodcutters=.1*labor
                builders=.8*labor
                farmers=.8*labor
                if self.forests==0 or self.forests<0:
                    wood=0
                if self.forests>0:
                    wood=woodcutters*self.forests
                    self.forests=self.forests-(wood*.2)
                self.forests=self.forests+(self.forests*.1)+2
                print(self.forests)
                newhouses=wood*.1*(builders/(.1*(wood+.00001)))
                self.houses=self.houses+newhouses
                fooduse=self.pop
                if (self.pop*.2)<self.farmland:
                    food=1.4*farmers
                if (self.pop*.2)>self.farmland:
                    food=farmers
                    #print("ohno")
                housecap=self.houses
                foodcap=food
                if self.pop<foodcap and self.pop<housecap:
                    self.pop=self.pop+(.1*(self.pop))
                elif self.pop>foodcap:
                    self.pop=self.pop-(self.pop-foodcap)
                else: 
                    self.pop=self.pop
                g=self.pop
                inventors=random.randint(1,10)*(.01*self.pop)+(.0005*(food-fooduse))
                techadvancechance=0
                print("The number of forests is {0}".format(round(self.forests,0)))
                print("The housecap of your civilization is {0}".format((housecap)))
                print("The population of your civilization is {0}".format(round(g, 0)))
                print("The food output of your civilization is {0}".format(round(food,0)))
                print("The food use of your civilization is {0}".format(round(fooduse,0)))
                if self.initialtechlevel=="ancient" and inventors>10:
                    techadvancechance=random.randint(0,10)*inventors*.4
                    self.techadvanceprogress=self.techadvanceprogress+.025*(techadvancechance)
                    #print(self.techadvanceprogress)
                    if self.techadvanceprogress>=10:
                        print("eureka")
                        self.techlevel="classical"

            if self.techlevel=="classical":
                labor=self.pop
                miners=.04*labor
                smelters=.004*labor
                forgers=.005*labor
                farmers=.8*labor
                builders=.075*labor
                woodcutters=.075*labor
                artisans=.001*labor
                self.forests=self.forests+(self.forests*.1)+(2*random.randint(1,2))
                newbetterhouses=0
                if self.forests==0 or self.forests<0:
                    wood=0
                    print("Ispeakforthetrees")
                if self.forests>0:
                    wood=woodcutters*.15*self.forests*(self.tools*(self.tools/woodcutters))
                    self.forests=self.forests-(wood*.2)
                    self.farmland=self.farmland+(self.forests-(self.forests-(wood*.5)))
                if self.metaldeposits > 0:
                    newore=miners*self.metaldeposits
                    self.metaldeposits=self.metaldeposits-(newore*.1)
                    self.ore=self.ore+newore
                if self.metaldeposits<0:
                    newore=0
                if self.ore>0:
                    newingots=.5*self.ore*((20*smelters)/self.ore)
                    self.ingots=self.ingots+newingots
                    ingotmarker=self.ingots
                if self.ingots>0:
                    newtools=.2*self.ingots
                    self.tools=self.tools+newtools
                    self.ingots=self.ingots-(.2*ingotmarker)
                if self.ingots>0:
                    newbarrels=.2*self.ingots
                    self.barrels=self.barrels+newbarrels
                    self.ingots=self.ingots-(.2*ingotmarker)
                if self.ingots>0:
                    newconsumergoods=.2*self.ingots
                    self.comsumergoods=self.consumergoods+newconsumergoods
                    self.ingots=self.ingots-(.2*ingotmarker)
                if self.ingots>0 and wood>0:
                    newbetterhouses=.02*(builders/(.1*(self.ingots+.00001)))*(builders/(.1*(wood+.00001)))
                    self.ingots=self.ingots-(.2*ingotmarker)
                if self.ingots>0:
                    newweapons=.2*self.ingots
                    self.weapons=self.weapons+newweapons
                newhouses=.08*wood*((builders/(.1*(wood+.000001))))
                self.houses=self.houses+newhouses+(1.1*newbetterhouses)
                fooduse=4*farmers
                if (self.pop*.1)<self.farmland:
                    food=1.6*farmers*(self.tools*(.5*(farmers/self.tools)))
                if (self.pop*.1)>self.farmland:
                    food=farmers
                    print("pleasegodnoyouroneofthemanr'tyou")
                housecap=self.houses
                foodcap=food
                if self.pop<foodcap and self.pop<housecap:
                    popgrowth=self.pop+(.1*(self.pop))
                    if (popgrowth+self.pop)>housecap:
                        self.pop=self.pop+
                elif self.pop>foodcap:
                    self.pop=self.pop-(self.pop-foodcap)
                elif self.pop>housecap: 
                    self.pop=self.pop
                    print("feels like a tokyo subway")
                g=self.pop
                inventors=random.randint(1,10)*(.01*self.pop)+(.0005*(food-fooduse))
                techadvancechance=0
                print("The housecap of your civilization is {0}".format((housecap)))
                print("The population of your civilization is {0}".format(round(g, 0)))
                print("The food output of your civilization is {0}".format(round(food,0)))
                #print("The food use of your civilization is {0}".format(round(fooduse,0)))

                    
                    
                    

            self.k=self.k-8



    


myapp = CivGame()
myapp.run()
